{% extends 'base.html' %}

{% block content %}
<!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ —Ñ–∏–ªÔøΩÔøΩ—Ç—Ä–∞—Ü–∏–∏ -->
<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#filter-modal">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –¥–∏–∞–º–µ—Ç—Ä—É</button>

<!-- –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<div class="modal fade" id="filter-modal" tabindex="-1" aria-labelledby="filter-modal-label" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="filter-modal-label">–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–º–µ—Ç—Ä—É</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–∏–∞–º–µ—Ç—Ä–æ–≤ -->
        <select id="diameter-select" class="form-select">
          {% for tool in tools %}
            <option value="{{ tool.diameter }}">{{ tool.diameter }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" id="filter-button">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
      </div>
    </div>
  </div>
</div>

<!-- –î–æ–±–∞–≤–ª—è–µ–º JavaScript –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<script>
  document.getElementById('filter-button').addEventListener('click', function() {
    const diameter = document.getElementById('diameter-select').value;
    const url = `/tools/?diameter=${diameter}`;
    window.location.href = url;
  });
</script>
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Tools</h1>
    <div>
        <a href="/create/" class="btn btn-success">Add New Tool</a>
        <form id="search-form" method="GET" action="/" class="d-inline ms-3">
            <div class="input-group">
                <input id="search-input" type="text" name="search" class="form-control" placeholder="Search..." value="{{ search }}">

            </div>
        </form>
    </div>
</div>
<table class="table table-dark table-hover">
    <thead>
        <tr>
            <th>
                <a href="/?sort_by=id&order={{ 'desc' if order == 'asc' else 'asc' }}">ID</a>
                {% if sort_by == 'id' %}
                    <span>{{ '‚ñ≤' if order == 'asc' else '‚ñº' }}</span>
                {% endif %}
            </th>
            <th>
                <a href="/?sort_by=name&order={{ 'desc' if order == 'asc' else 'asc' }}">Name</a>
                {% if sort_by == 'name' %}
                    <span>{{ '‚ñ≤' if order == 'asc' else '‚ñº' }}</span>
                {% endif %}
            </th>
            <th>
                <a href="/?sort_by=diameter&order={{ 'desc' if order == 'asc' else 'asc' }}">Diameter</a>
                {% if sort_by == 'diameter' %}
                    <span>{{ '‚ñ≤' if order == 'asc' else '‚ñº' }}</span>
                {% endif %}
            </th>
            <th>
                <a href="/?sort_by=lenght&order={{ 'desc' if order == 'asc' else 'asc' }}">Length</a>
                {% if sort_by == 'lenght' %}
                    <span>{{ '‚ñ≤' if order == 'asc' else '‚ñº' }}</span>
                {% endif %}
            </th>
            <th>
                <a href="/?sort_by=deep_of_drill&order={{ 'desc' if order == 'asc' else 'asc' }}">Deep of Drill</a>
                {% if sort_by == 'deep_of_drill' %}
                    <span>{{ '‚ñ≤' if order == 'asc' else '‚ñº' }}</span>
                {% endif %}
            </th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% if tools %}
            {% for tool in tools %}
            <tr>
                <td>{{ tool.id }}</td>
                <td>{{ tool.name }}</td>
                <td>{{ tool.diameter }}</td>
                <td>{{ tool.lenght }}</td>
                <td>{{ tool.deep_of_drill }}</td>
                <td>
                    <a href="/update/{{ tool.id }}" class="btn btn-warning btn-sm">‚úèÔ∏è</a>
                    <form method="POST" action="/delete/{{ tool.id }}" class="d-inline">
                        <button type="submit" class="btn btn-danger btn-sm">üóëÔ∏è</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="6" class="text-center">No tools found</td>
            </tr>
        {% endif %}
    </tbody>
</table>

<script>
document.getElementById('search-input').addEventListener('input', function() {
    const form = document.getElementById('search-form');
    form.submit();
});
</script>
{% endblock %}
